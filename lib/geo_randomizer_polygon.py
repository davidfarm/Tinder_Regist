import random
from shapely.geometry import Polygon, Point

def polygon_random_points (poly, num_points):
    min_x, min_y, max_x, max_y = poly.bounds
    points = []
    while len(points) < num_points:
            random_point = Point([random.uniform(min_x, max_x), random.uniform(min_y, max_y)])
            if (random_point.within(poly)):
                points.append(random_point)

    return points
# Choose the number of points desired. This example uses 20 points.


def get_geo(city):
    match city:
        case "msk":
            geo = Polygon([(55.76664217677472, 37.536612561151145), (55.78421407372232, 37.551375439569114),
                            (55.78749585758228, 37.589827588006614), (55.77398085539273, 37.600813916131614),
                            (55.75640434392775, 37.585021069451926), (55.74442459958629, 37.57300477306521),
                            (55.74597057977355, 37.510863354608176)])
        case "piter":
            geo = Polygon([(59.862221743726344, 30.23731712041689), (59.843254994647296, 30.337567364557515),
                                (59.86773731376941, 30.456357037409077), (59.91905715596102, 30.47077659307314),
                                (59.992282844026626, 30.44056419072939), (60.033465533251054, 30.401425396784077),
                                (60.02283158573057, 30.255169903620015), (59.94589097499788, 30.202298199518452)])
        case "dubai":
            geo = Polygon([(25.10625739187248, 55.10940971287425), (25.137342085298265, 55.12812080296216),
                             (25.12164530347815, 55.17343940647777), (25.200248760569398, 55.27402593303083),
                             (25.197755908429965, 55.28385136554528), (25.098842698970344, 55.230162088587065),
                             (25.052042503466414, 55.220892374231596), (25.043644563363053, 55.19874805660464)])
        case "istan":
            geo = Polygon([(41.00105872301189, 28.93345211749414), (41.002289459365386, 28.949845778993165),
                             (41.00274288275486, 28.967870223573243), (41.00753602492834, 28.98495053058008),
                             (41.01440126986385, 28.98014401202539), (41.02171909224387, 28.962033736756837),
                             (41.033808259213565, 28.946486804811286), (41.01347550277931, 28.92142424377613)])
        case "paris":
            geo = Polygon([(48.84115096189658, 2.2630011918126343), (48.82533144006684, 2.317761171060681),
                             (48.820245532909034, 2.3673713090001343), (48.831772848244064, 2.3993003251134155),
                             (48.8602407305678, 2.4101149918614624), (48.88543960168695, 2.3898688726555974),
                             (48.89474395227992, 2.313995361328125), (48.87584398242905, 2.287902014745451)])
        case "london":
            geo = Polygon([(51.514527007218526, -0.1642888689132178), (51.48685024113087, -0.13304649830774906),
                              (51.48941559015264, -0.09459434987024906), (51.51217673819583, -0.07502495289759281),
                              (51.52862607501406, -0.11244713307337406)])
        case "budapest":
            geo = Polygon([(47.42046403230339, 18.961549601866807), (47.555950514757896, 19.029527507140244),
                                (47.545291313640526, 19.177842936827744), (47.41767639876871, 19.21766837628087),
                                (47.3772391261066, 19.089265666319932)])
        case "warszawa":
            geo = Polygon([(52.25058847354135, 20.890312462958548), (52.18201512640452, 20.930824547919485),
                                (52.14663536943653, 21.041374474677298), (52.21862879759926, 21.160850793036673),
                                (52.32031513309995, 21.03519466510699)])
        case "ireland":
            geo = Polygon([(53.282084508187026, -6.282442480638437), (53.318605949517604, -6.369646460130625),
                               (53.389761193696195, -6.338342404183381), (53.390989656873174, -6.182130551156037),
                               (53.29732019017387, -6.187967037972443)])

        case "spain":
            geo = Polygon([(39.745663412677196, -3.6829585167811274), (40.20240292996595, -4.468480977718627),
                           (40.778908029910895, -4.048253926937377), (40.628993001264135, -2.8919428917811274),
                           (39.93324090798401, -2.6912884671196546)])

        case "slovenia":
            geo = Polygon([(46.054856171143584, 14.066980876888694), (45.831398737736556, 14.308680095638694),
                           (45.81130082146247, 14.58471158977932), (45.92700357562966, 14.822290935482444),
                           (46.205228351607, 14.575098552669944)])

        case "canada":
            geo = Polygon([(46.776517544623154, -71.06374157214174), (46.663540154210565, -71.18733776354799),
                           (46.606962740002665, -71.37135875964174), (46.754881869965885, -71.63915050768861),
                           (46.89958114336809, -71.54164684557924), (46.99801643775559, -71.08022106432924)])

        case "talin":
            geo = Polygon([ (59.40418128131692, 24.741839936362393), (59.423665963047846, 24.65607114836118),
                           (59.450899376196176, 24.7039646725311), (59.450201357352334, 24.82378431364438),
                            (59.42298517527463, 24.807205643414022)])

        case "riga":
            geo = Polygon([ (56.98706833358279, 24.01002658961061), (56.910672877220165, 24.027879372813736),
                           (56.9016748818956, 24.236619607188736), (56.994549659933305, 24.17756809351686)])

        case "vilnus":
            geo = Polygon([ (54.653892468163406, 25.2550236173985), (54.702326146332815, 25.20283855880475),
                           (54.72850389393886, 25.26326336349225), (54.68367411199563, 25.32368816817975)])

        case "praha":
            geo = Polygon([ (50.035114370550936, 14.41063407265306), (50.10048871701151, 14.38368323647142),
                           (50.125346627157604, 14.473572528846823), (50.06591372671052, 14.512254695818143)])

        case "madrid":
            geo = Polygon([ (40.32508148059212, -3.831354695774729), (40.34811103656983, -3.632227498509104),
                           (40.445376387752475, -3.582789021946604), (40.45896142496105, -3.746210652805979)])


        case "berlin":
            geo = Polygon([ (52.41104761729616, 13.557043965481421), (52.41020991227858, 13.238440449856421),
                           (52.564914677438004, 13.248053486965796), (52.57409620479454, 13.526831563137671)])

        case "berlin":
            geo = Polygon([ (52.41104761729616, 13.557043965481421), (52.41020991227858, 13.238440449856421),
                           (52.564914677438004, 13.248053486965796), (52.57409620479454, 13.526831563137671)])

        case "hamburg":
            geo = Polygon([ (53.45910979102119, 10.118750966868548), (53.47219021441665, 9.853705800852923),
                           (53.61336502947748, 9.872931875071673), (53.65814860056984, 10.131110586009173)])

        case "stockholm":
            geo = Polygon([ (59.235864077558524, 17.99897625365024), (59.38970265487938, 17.868513607165866),
                           (59.35752076624716, 18.09236004271274), (59.28640265628598, 18.15827801146274)])

        case "helsinki":
            geo = Polygon([ (60.148452760114694, 24.649314586443502), (60.20980432367178, 25.135345458984375),
                           (60.307337336255664, 25.04106701344505), (60.230377912341, 24.77945507496849)])

        case "brussel":
            geo = Polygon([ (50.788162574485575, 4.352476880755578), (50.86146623458091, 4.2693927743102655),
                           (50.92182627057241, 4.3638561180218005), (50.83430886412055, 4.479899208842113)])

        case "europa":
            geo = Polygon([(36.82503623833841, -3.7355473647661808), (38.90634570140047, -8.17402392726618),
                           (43.14741827736776, -5.80097705226618), (43.2435296374103, -1.6261723647661808),
                           (46.60258915171, -1.2306645522661808), (51.76641848531801, -4.52656298976618),
                           (55.265289503118886, -1.6261723647661608), (52.307074308771874, 1.5818354477338392),
                           (53.57809783857309, 7.558397947733839), (56.73515404143301, 8.771317097028101),
                           (60.898633966654224, 16.05010825346678), (63.319859920211314, 23.379269700555252),
                           (63.12186408346303, 31.245480638055252), (59.341340186776804, 28.081418138055252),
                           (55.46300340341263, 26.587277513055252), (53.24926683993937, 23.486290438677173),
                           (50.216158740297054, 23.29957029651645), (48.02121461187899, 21.93726560901645),
                           (46.711673894705086, 28.61695310901645), (42.65220054285966, 27.82593748401645),
                           (40.98203172843039, 24.44214842151645), (39.67554575768405, 22.55249998401645),
                           (36.917023974521655, 22.37671873401645), (38.81442827394492, 16.41050295273401),
                           (44.26916977954148, 9.027690452734012), (43.34952031844717, 3.886088890234012)])


    return geo

def get_points(city):
    geo = get_geo(city)
    points = polygon_random_points(geo,1)

    for p in points:
        latitude = str(p.x)
        longitude = str(p.y)

    return latitude, longitude


def group_id_list(group_id, port):
    match (group_id, port):
#        case ("t_spam", "34999"):
#            g_id = ""
#        case ("t_spam", "35000"):
#            g_id = ""

        case ("merlyn", "34999"):
           g_id = "7506a15d-cca9-4ebd-be36-addf2bd53a52"
        case ("merlyn", "35000"):
           g_id = "584811b7-246c-457a-961a-7344262a90f2"

        case ("david", "34999"):
           g_id = "7506a15d-cca9-4ebd-be36-addf2bd53a52"
        case ("david", "35000"):
           g_id = "584811b7-246c-457a-961a-7344262a90f2"

        case ("FA001", "34999"):
            g_id = "a9c92733-f9a5-45d3-8b9b-494541b236d9"
        case ("FA001", "35000"):
            g_id = "4bc1480b-6b74-464b-83be-082fc71f7bd3"

        case ("FA002", "34999"):
            g_id = "3d4663c9-d23b-484e-8946-b052c436386d"
        case ("FA002", "35000"):
            g_id = "5baf834e-6f78-4f4d-a262-0cb5ee366df2"

        case ("FA003", "34999"):
            g_id = "263503bf-473f-4bd7-aa07-4b30b90b567b"
        case ("FA003", "35000"):
            g_id = "c264d602-8df3-4123-962c-f8fcdbdd06eb"

        case ("FA004", "34999"):
            g_id = "9b0e1cf3-0b73-469a-9ec8-51c2ece19721"
        case ("FA004", "35000"):
            g_id = "8bb79dbf-8b23-426c-bfa2-13394b043095"

        case ("FA005", "34999"):
            g_id = "3e2d5f12-6b00-4203-abde-4d0559d1ec36"
        case ("FA005", "35000"):
            g_id = "0a79e12e-188f-441b-8919-52edc44a097f"

        case ("FA006", "34999"):
            g_id = "4eb3cf01-3baf-4b1d-9597-bf68a4eb44a2"
        case ("FA006", "35000"):
            g_id = "2da42aed-49f7-4125-b572-a5c67fb41a97"

        case ("FA007", "34999"):
            g_id = "19663c6d-bdd2-4437-a28d-426f524b9084"
        case ("FA007", "34999"):
            g_id = "5f82e9d6-3c0d-433d-90f4-68168f003cb6"

        case ("FA008", "34999"):
            g_id = "109058f5-4bee-4351-a6bc-dac0be5db846"
        case ("FA008", "35000"):
            g_id = "43b12eec-791f-4c90-86ae-0deaf02d87bd"


        case (_, "35000"):
            g_id = "00000000-0000-0000-0000-000000000000"


    return g_id

